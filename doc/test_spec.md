# MCPクライアントテスト仕様書

## 1. 概要

このドキュメントは、`spec.md` に基づくMCPクライアントのテストの概要を説明します。すべてのテストは `pytest` フレームワークを使用して実装されます。

## 2. 単体テスト

### 2.1. PDFローダー (`test_pdf_loader.py`)

- **`test_find_pdfs`**:
  - **目的**: PDFローダーがディレクトリ内のすべての `.pdf` ファイルを見つけられることを検証する。
  - **セットアップ**: PDFファイルと非PDFファイルを混在させた一時ディレクトリを作成する。
  - **アサーション**: 見つかったファイルのリストにPDFファイルへのパスのみが含まれていることをアサートする。

- **`test_extract_text_from_pdf`**:
  - **目的**: PDFファイルからテキストが正しく抽出されることを検証する。
  - **セットアップ**: 既知のテキストコンテンツを持つシンプルなPDFファイルを作成する。
  - **アサーション**: 抽出されたテキストが期待されるコンテンツと一致することをアサートする。

### 2.2. MCPクライアント統合 (`test_mcp_client.py`)

- **`test_create_resources_from_pdfs`**:
  - **目的**: MCPクライアントがPDFファイルからリソースを正しく作成することを検証する。
  - **セットアップ**:
    1. `fastmcp.Client` をモック化する。
    2. サンプルPDFファイルを含む一時ディレクトリを作成する。
    3. メインアプリケーションロジックを実行する。
  - **アサーション**:
    - `client.set_resource` メソッドが呼び出されたことをアサートする。
    - 正しいリソースID（例: `pdf/sample.pdf`）で呼び出されたことをアサートする。
    - リソースコンテンツがPDFから抽出されたテキストと一致することをアサートする。

## 3. テスト環境

- `pytest` 環境がセットアップされます。
- `requirements.txt` には `pytest`、`fastmcp`、`pdfplumber` が含まれます。
- テストは `pytest` コマンドで実行可能です。